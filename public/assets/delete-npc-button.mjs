import{env as e}from"./env.mjs";import{snackbar as t}from"./notifyjs.mjs";class i extends HTMLElement{constructor(){super(),this.delete=async()=>{var i;if(this.isDeleting)return;const n=e.startLoading();this.isDeleting=!0;const s={CRAFT_CSRF_TOKEN:document.documentElement.dataset.csrf,entryId:this.dataset.entryId},o=await fetch(location.origin+"/actions/entries/delete-entry",{method:"POST",body:JSON.stringify(s),headers:new Headers({Accept:"application/json","Content-Type":"application/json"}),credentials:"include"});if(o.ok){const s=await o.json();if(s.success)location.href=`${location.origin}/campaign/${this.dataset.campaignUid}`;else{const o=(null==s?void 0:s.error)||(null===(i=null==s?void 0:s.errors)||void 0===i?void 0:i[0])||null;o&&t({message:o,closeable:!0,force:!0,duration:3}),this.isDeleting=!1,e.stopLoading(n)}}else{await o.text();t({message:"Failed to delete NPC, try again later.",closeable:!0,force:!0,duration:3}),this.isDeleting=!1,e.stopLoading(n)}},this.isDeleting=!1}connectedCallback(){this.addEventListener("click",this.delete)}}customElements.define("delete-npc-button",i);